function afisha(){$(".afisha-slider").length&&$(".afisha-slider").each(function(){let t=$(this);const e=new Swiper(".afisha-slider__swiper",{slidesPerView:"auto",speed:2e3,spaceBetween:194,preventClicks:!1});let o=!1,n="",a=0;setInterval(function(){o&&(0==a&&(console.log(n),"LEFT"==n&&e.slidePrev(),"RIGHT"==n)&&e.slideNext(),2e3==(a+=100))&&(a=0)},100);$(this).hover(function(){o=!0},function(){o=!1});var r=$(this).find(".afisha-slider__cursor");$(this).mousemove(function(e){console.log(t.offset().top),gsap.to(r,.23,{left:e.pageX-t.offset().left,top:e.pageY-t.offset().top,ease:Power4.easOut}),n="",o&&e.clientX<window.innerWidth/3&&(o=!0,n="LEFT",a=0,console.log("autoplay left")),o&&e.clientX>window.innerWidth-window.innerWidth/3&&(a=0,o=!0,n="RIGHT",console.log("autoplay right"))})})}function bookTable(){$(".book").length&&$(".book").click(function(){barba.go($(".svg-map").data("href")+$(this).data("table"))}),$(".book-table__gallery").length&&($("#booktable-form").validate({errorPlacement:function(e,t){},submitHandler:function(e){$("#booktable-form button[type='submit']").attr("disabled","disabled"),$.ajax({url:$(e).attr("action"),data:$(e).serialize(),method:"POST",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},context:document.body,success:function(){barba.go($("#booktable-form").data("thanks"))},error:function(){barba.go($("#booktable-form").data("error"))}})}}),$(".book-table__gallery").each(function(){let t=$(this),e=new Swiper(t.find(".book-table__swiper")[0],{centeredSlides:!0,loop:!0,loopedSlides:7,observerParent:!0,observerUpdate:!0,observer:!0,slidesPerView:1,speed:2e3,spaceBetween:0});let o=!1,n="",a=0;setInterval(function(){console.log(),o&&(0==a&&(console.log(n,t,e),"LEFT"==n&&e.slidePrev(),"RIGHT"==n)&&e.slideNext(),2e3==(a+=100))&&(a=0)},100);$(this).hover(function(){o=!0},function(){o=!1});let r=$(this).find(".book-table__cursor");$(this).mousemove(function(e){console.log(e),gsap.to(r,.23,{left:e.pageX-t.offset().left,top:e.pageY-t.offset().top,ease:Power4.easOut}),n="",o&&e.clientX<$(this).innerWidth()/2&&(o=!0,n="LEFT",a=0,console.log("autoplay left")),o&&e.clientX>$(this).innerWidth()/2&&(a=0,o=!0,n="RIGHT",console.log("autoplay right"))})}))}function bookCorp(){$("#bookcorp-form").validate({errorPlacement:function(e,t){},submitHandler:function(e){$("#bookcorp-form button[type='submit']").attr("disabled","disabled"),$.ajax({url:$(e).attr("action"),data:$(e).serialize(),method:"POST",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},context:document.body,success:function(){barba.go($("#bookcorp-form").data("thanks"))},error:function(){barba.go($("#bookcorp-form").data("error"))}})}})}function front(){var e=!1;$(".front__player-play").click(function(){e?($(".front__player-play").removeClass("_play"),$(".front__player-audio")[0].pause(),e=!1):(e=!0,$(".front__player-play").addClass("_play"),$(".front__player-audio")[0].play())});let n=$(".front-card").length;var t=$(".front-card").length,o=t-1;let a=20,r=25,i=(window.innerWidth<900&&(a=10,r=10),.1),s=(window.innerWidth<900&&(i=.2),!1),l=[];for(let e=1;e<=n;e++)l.push(e);function c(){s=!0,setTimeout(function(){s=!1},1e3),console.log("frontDown");var t=[];t.push(l[n-1]);for(let e=0;e<n-1;e++)t.push(l[e]);l=t,console.log(l),l.forEach((e,t)=>{var o;0==t?(console.log("#front-card-"+l[0]),gsap.to("#front-card-"+l[0],{top:window.innerWidth<992?window.innerHeight:window.innerHeight-300,zIndex:1e3,width:$(".front__swiper").width(),marginLeft:0,duration:i})):(o=n-1-t,gsap.to("#front-card-"+e,{top:r*o*-1,zIndex:100*(t+1),width:$(".front__swiper").width()-2*a*o,marginLeft:a*o,duration:i}))})}function d(){s=!0,setTimeout(function(){s=!1},1e3),console.log("frontUp");var t=[];for(let e=1;e<n;e++)t.push(l[e]);t.push(l[0]),l=t,console.log(l),l.forEach((e,t)=>{var o=n-1-t;t==n-1?gsap.to("#front-card-"+l[n-1],{top:0,zIndex:1e3,width:$(".front__swiper").width(),marginLeft:0,duration:i}):0==t?(console.log("#front-card-"+l[0]),gsap.to("#front-card-"+l[0],{top:window.innerHeight-300,zIndex:0,width:$(".front__swiper").width(),marginLeft:0,duration:i})):gsap.to("#front-card-"+e,{top:r*o*-1,zIndex:100*(t+1),width:$(".front__swiper").width()-2*a*o,marginLeft:a*o,duration:i})})}console.log(l),l.forEach((e,t)=>{var o=n-1-t;t==n-1?gsap.to("#front-card-"+l[n-1],{top:0,zIndex:1e3,width:$(".front__swiper").width(),marginLeft:0,duration:i}):0==t?(console.log("#front-card-"+l[0]),gsap.to("#front-card-"+l[0],{top:window.innerHeight-300,zIndex:0,width:$(".front__swiper").width(),marginLeft:0,duration:i})):gsap.to("#front-card-"+e,{top:r*o*-1,zIndex:100*(t+1),width:$(".front__swiper").width()-2*a*o,marginLeft:a*o,duration:i})}),$(".front__swiper").on("mousewheel",function(e){$("#front-top").attr("state");0<e.originalEvent.wheelDelta/120?s||c():s||d(),$(".front__number").text($("#front-card-"+l[n-1]).data("number"))}),$(".front__swiper").swipe({preventDefaultEvents:!1,swipe:function(e,t,o,n,a,r){console.log(t),30<=o&&("down"==t&&window.innerWidth<992&&c(),"up"==t)&&window.innerWidth<992&&d()}}),console.log(t,o)}function gallery(){$(".gallery-slider").length&&($(".calendar-block .arrow-link").click(function(){$(".calendar-block").toggleClass("_open")}),$(".air-calendar-select").each(function(){new AirDatepicker(this,{inline:!0,onSelect({formattedDate:e}){console.log($(".calendar-block").data("href")+e),barba.go($(".calendar-block").data("href")+e)}})}),$(document).on("click",".gallery-slider__swiper .swiper-slide",function(){console.log("click"),$(".popup-gallery").fadeIn();var e=$(this).attr("slide");$(".popup-gallery__swiper")[0].swiper.slideTo(e)}),$(".gallery-slider").each(function(){var e=$(this);let t=0;e.find(".swiper-slide").each(function(){$(this).attr("slide",t),t++}),$(".popup-gallery__swiper .swiper-wrapper").html(e.find(".swiper-wrapper").html());new Swiper(e.find(".gallery-slider__swiper")[0],{observerParent:!0,observerUpdate:!0,observer:!0,loop:!0,preventClicks:!1,slidesPerView:"auto",mousewheel:{forceToAxis:!0},preventClicksPropagation:!1,preventInteractionOnTransition:!1,spaceBetween:20,breakpoints:{600:{spaceBetween:50},1300:{spaceBetween:97}}})}),$(".js-tilt").tilt({perspective:3e3}))}function clubCard(){$("#card-form").validate({errorPlacement:function(e,t){},submitHandler:function(e){$("#card-form button[type='submit']").attr("disabled","disabled"),$.ajax({url:$(e).attr("action"),data:$(e).serialize(),method:"POST",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},context:document.body,success:function(){barba.go($("#card-form").data("thanks"))},error:function(){barba.go($("#card-form").data("error"))}})}})}function popup(){$(".popup-gallery__close").click(function(){$(".popup-gallery").fadeOut()}),$(".popup-gallery__slider").each(function(){var e=$(this);new Swiper(e.find(".popup-gallery__swiper")[0],{observerParent:!0,observerUpdate:!0,observer:!0,loop:!0,slidesPerView:1,loopedSlides:7,mousewheel:{forceToAxis:!0},spaceBetween:20,breakpoints:{600:{spaceBetween:50},1300:{spaceBetween:97}}})})}function components(){function e(){$(".block__tab").each(function(){$(this).hasClass("_active")?$($(this).data("tab")).removeClass("_d-none"):$($(this).data("tab")).addClass("_d-none")})}$(".block__head").append('<span class="block__head-line"></span>'),$(".block h2,.block .h2:not(a)").each(function(){console.log($(this));var n=$(this),e=($(this).after('<div class="block__h2-lines h2">'),$(this).wrap('<div class="block__h2-default">'),$(this).html().replace(/[\wа-яё,.!:;(&)\-]+/gim,function(e){return"br"===e||"i"===e?e:"<span>"+e+"</span>"}));$(this).html(e),console.log(e),$(this).find("i span").each(function(){$(this).html("<i>"+$(this).text()+"</i>")});let t=1,o=0;$(this).find("span,br").each(function(){$(this).position().top>=o+30&&(t++,o=$(this).position().top),$(this).attr("line",t)});var a=$(this).closest(".block__h2-default").next(".block__h2-lines");for(let o=1;o<30;o++){let e=$("<div>",{class:"block__h2-line-"+o}),t=0;n.find("span[line='"+o+"']").each(function(){e.append($(this).clone()),e.append(" "),t=1}),t&&(a.append(e),e.wrap('<div class="block__h2-line-wrap">'))}}),window.addEventListener("resize",function(e){$(".block h2,.block .h2:not(a)").each(function(){var n=$(this);let e=1,t=0;$(this).find("span,br").each(function(){$(this).position().top>=t+30&&(e++,t=$(this).position().top),$(this).attr("line",e)});var a=$(this).closest(".block__h2-default").next(".block__h2-lines");a.html("");for(let o=1;o<30;o++){let e=$("<div>",{class:"block__h2-line-"+o}),t=0;console.log(n.html()),n.find("span[line='"+o+"']").each(function(){e.append($(this).clone()),e.append(" "),t=1}),t&&(a.append(e),e.wrap('<div class="block__h2-line-wrap">'))}})},!0),$(".photo-slider").length&&$(".photo-slider").each(function(){var e=$(this);new Swiper(e.find(".photo-slider__swiper")[0],{centeredSlides:!0,loop:!0,loopedSlides:7,observerParent:!0,observerUpdate:!0,observer:!0,freemode:!0,slidesPerView:"auto",mousewheel:{forceToAxis:!0},preventClicks:!1,spaceBetween:20,breakpoints:{600:{spaceBetween:100},1300:{spaceBetween:215}}})}),$(".block__tabs .block__tab").click(function(){$(this).closest(".block__tabs").find(".block__tab").removeClass("_active"),$(this).addClass("_active"),e()}),e(),$(".air").each(function(){new AirDatepicker(this,{})}),$(".select2-wrap").each(function(){$(this).find(".select2").select2({minimumResultsForSearch:-1,dropdownParent:$(this),placeholder:$(this).find(".select2").attr("placeholder")})}),$("._mask-phone").each(function(){$(this).inputmask("+7 999-999-99-99",{skipOptionalPartCharacter:" "})}),$("._mask-count").length&&new Cleave("._mask-count",{numeral:!0,delimiter:" ",numeralThousandsGroupStyle:"thousand"}),$("._mask-price").length&&new Cleave("._mask-price",{numeral:!0,delimiter:" ",prefix:" руб",tailPrefix:!0,noImmediatePrefix:!0,numeralThousandsGroupStyle:"thousand"}),$("._mask-date").length&&new Cleave("._mask-date",{date:!0,delimiter:".",datePattern:["d","m","Y"]})}function header(){$(".header__open-menu").click(function(){$(".header").toggleClass("_open-menu")}),$(".header-menu__item a").click(function(){$(".header").removeClass("_open-menu")}),$(".header__contact").click(function(){$(".header").removeClass("_open-menu")})}$(function(){}),$(function(){}),$(function(){}),$(function(){}),$(function(){}),$(function(){}),$(function(){}),$(function(){function e(){AOS.init({startEvent:"DOMContentLoaded",initClassName:"aos-init",animatedClassName:"is-inview",useClassNames:!1,disableMutationObserver:!1,debounceDelay:50,throttleDelay:99,offset:120,delay:0,duration:1e3,easing:"ease",once:!1,mirror:!1,anchorPlacement:"top-bottom"})}components(),e(),bookTable(),afisha(),gallery(),bookCorp(),front(),clubCard(),barba.hooks.after(()=>{console.log("after"),e()}),barba.hooks.before(()=>{setTimeout(function(){components(),bookTable(),afisha(),gallery(),clubCard(),bookCorp(),front()},100)}),barba.init({transitions:[{sync:!0,name:"card",from:{namespace:["front"]},to:{namespace:["chapter"]},beforeLeave(){gsap.to(".front-card",{top:0,zIndex:0,width:$(".front__swiper").width(),marginLeft:0,duration:.2})},afterLeave(){$("html").removeClass("_cards-aniimte  "),$(".cards-current").removeClass("cards-current"),$(".cards-next").removeClass("cards-next"),console.log("afterLeave")},after(e){console.log("after")},leave(e){return $("html,body").scrollTop(0),$("html").addClass("_cards-aniimte"),$(e.current.container).addClass("cards-current"),console.log("leave"),gsap.to(e.current.container,{opacity:0,duration:.5})},enter(e){return $(e.next.container).addClass("cards-next"),setTimeout(function(){$(e.next.container).addClass("cards-next-anim")},50),gsap.to(e.next.container,{duration:1,y:0,top:window.innerWidth<=1024?102:172})}},{sync:!0,name:"chapter",from:{namespace:["chapter"]},to:{namespace:["chapter"]},afterLeave(){$("html").removeClass("_chapter-aniimte  "),$(".chapter-current").removeClass("chapter-current"),$(".chapter-next").removeClass("chapter-next")},leave(e){return $("html,body").scrollTop(0),$("html").addClass("_chapter-aniimte"),$(e.current.container).addClass("chapter-current"),gsap.to(e.current.container,{y:-1*window.innerHeight+400+(window.innerWidth<=1024?102:172)+(window.innerWidth<=1024?40:61),duration:1})},enter(e){return $(e.next.container).addClass("chapter-next"),gsap.to(e.next.container,{duration:1,y:0})}}]})}),$(function(){popup()}),$(function(){header()});